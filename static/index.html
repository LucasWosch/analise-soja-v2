<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CSV Analyzer üåæ</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-[#0b0f0e] text-white">
  <main class="flex flex-col md:flex-row w-full h-screen">

    <!-- COLUNA ESQUERDA -->
    <div class="md:w-[40%] flex flex-col items-center overflow-y-auto py-10 px-6 border-r border-black/40 bg-[#232c36]">

      <!-- HERO -->
      <header class="text-center py-10 px-6 max-w-md">
        <h1 class="text-5xl md:text-6xl text-white font-extrabold mb-6 drop-shadow-[0_0_10px_rgba(16,185,129,0.4)]">
          üåæ CSV Data Analyzer
        </h1>
        <p class="text-white/60 text-lg md:text-base">
          Fa√ßa upload de um CSV, treine o modelo e visualize previs√µes e gr√°ficos agr√≠colas interativos.
        </p>
      </header>

      <!-- UPLOAD -->
      <section class="mt-6 bg-black/30 p-6 rounded-xl border border-white/5 w-full max-w-md text-center">
        <h2 class="text-2xl font-semibold mb-6">Importar Dados</h2>
        <input id="file" type="file" accept=".csv" class="text-white/70 mb-4 w-full" />
        <button id="uploadBtn"
          class="w-full text-black py-3 rounded-lg font-semibold hover:brightness-110 transition bg-[#11c48d]">
          Enviar CSV
        </button>
        <p id="uploadStatus" class="text-white/60 mt-4"></p>
      </section>

      <!-- TRAIN -->
      <section class="mt-6 bg-black/30 p-6 rounded-xl border border-white/5 w-full max-w-md text-center">
        <h3 class="text-xl font-semibold mb-3 text-white">‚öôÔ∏è Treinar Modelo</h3>

        <div class="flex flex-col md:flex-row justify-center gap-4 mb-4">

          <!-- o valor real que vai pro backend -->
          <input id="target" type="hidden" value="yield_kg_ha" />

          <!-- o que o usu√°rio enxerga -->
          <p class="p-2 rounded bg-black/40 text-white w-full md:w-1/2 flex items-center">
            Produtividade (kg/ha)
          </p>

          <select id="model" class="p-2 rounded bg-black/40 text-white w-full md:w-1/3">
            <option value="random_forest">Random Forest</option>
            <option value="linear">Regress√£o Linear</option>
          </select>

        </div>

        <div class="flex gap-4 justify-center">
          <button id="trainBtn"
            class="px-6 py-3 rounded-lg font-semibold hover:brightness-110 transition bg-[#11c48d] text-black">
            Treinar
          </button>
          <button id="retrainBtn"
            class="px-6 py-3 rounded-lg font-semibold hover:brightness-110 transition bg-[#14d697] text-black">
            Re-treinar
          </button>
        </div>

        <pre id="trainout" class="bg-black/40 mt-6 p-4 rounded text-left text-sm overflow-x-auto"></pre>
      </section>


      <!-- PREDICT -->
      <section class="mt-6 bg-black/30 p-6 rounded-xl border border-white/5 w-full max-w-md text-center">
        <h3 class="text-xl font-semibold mb-3 text-white">Fazer Previs√£o</h3>
        <form id="predictForm" class="grid grid-cols-2 md:grid-cols-3 gap-4">
          <input name="crop" placeholder="Cultura" class="p-2 rounded bg-black/40 text-white" />
          <input name="year" placeholder="Ano" class="p-2 rounded bg-black/40 text-white" />
          <input name="season" placeholder="Esta√ß√£o" class="p-2 rounded bg-black/40 text-white" />
          <input name="area" placeholder="√Årea (ha)" class="p-2 rounded bg-black/40 text-white" />
          <input name="production" placeholder="Produ√ß√£o (t)" class="p-2 rounded bg-black/40 text-white" />
          <input name="rain_mm" placeholder="Chuva (mm)" class="p-2 rounded bg-black/40 text-white" />
          <input name="fertilizer_kg_ha" placeholder="Fertilizante (kg/ha)"
            class="p-2 rounded bg-black/40 text-white" />
          <input name="pesticide_kg_ha" placeholder="Pesticida (kg/ha)" class="p-2 rounded bg-black/40 text-white" />
        </form>
        <button id="predictBtn"
          class="mt-4 w-full py-3 rounded-lg font-semibold hover:brightness-110 transition bg-[#11c48d] text-black">
          Calcular Previs√£o
        </button>
        <p id="predictResult" class="text-emerald-400 mt-4"></p>
      </section>
    </div>


    <!-- COLUNA DIREITA (Dashboard) -->
    <div class="md:w-[60%] bg-gray-900/40 p-8 overflow-y-auto flex justify-center items-start"
      style="background-color: #232C36;">
      <section id="dashboard" class="w-full max-w-4xl bg-gray-900 p-8 rounded-2xl shadow-xl border border-gray-800"
        style="background-color: #181F26; border-color: #181F26;">
        <h2 class="text-2xl font-semibold font-semibold mb-4 text-center" style="color: #ffffff;">
          Resultados da An√°lise
        </h2>
        <div id="summary" class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8"></div>
        <div id="charts" class="space-y-10"></div>
      </section>
    </div>
  </main>


  <!-- DASHBOARD -->
  <!-- <section id="dashboard"
    class="hidden mt-20 w-full max-w-5xl bg-gray-900 p-8 rounded-2xl shadow-xl border border-gray-800">
    <h2
      class="text-2xl font-semibold mb-4 text-center text-transparent bg-clip-text bg-gradient-to-br from-cyan-400 to-blue-500">
      Resultados da An√°lise
    </h2>
    <div id="summary" class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8"></div>
    <div id="charts" class="space-y-10"></div>
  </section> -->

  <script src="/js/dashboard.js"></script>


  <!-- TOOLTIP -->
  <script>
    const fileInput = document.getElementById("file");
    const uploadBtn = document.getElementById("uploadBtn");
    const status = document.getElementById("uploadStatus");

    let tooltip;

    uploadBtn.addEventListener("mouseenter", (e) => {
      const file = fileInput.files[0];
      if (!file) return;

      if (tooltip) tooltip.remove();
      tooltip = document.createElement("div");
      tooltip.className = "absolute hidden z-50";

      const reader = new FileReader();
      reader.onload = (ev) => {
        const text = ev.target.result;
        const rows = text.split("\n").map(r => r.split(","));
        const headers = rows[0];
        const previewRows = rows.slice(1, 6);

        tooltip.innerHTML = `
  <div
    class="text-gray-300 p-3 rounded-lg border shadow-xl text-sm"
    style="background-color: #181F26; border-color: #181F26;">
    <div class="font-semibold text-white mb-2">Pr√©-visualiza√ß√£o CSV</div>
    <table class="border-collapse text-left">
      <thead>
        <tr>
          ${headers.map(h => `<th class='border-b border-gray-700 p-1 text-cyan-300 text-left'>${h}</th>`).join("")}
        </tr>
      </thead>
      <tbody>
        ${previewRows.map(r => `
          <tr>${r.map(c => `<td class='p-1 border-b border-gray-800'>${c}</td>`).join("")}</tr>
        `).join("")}
      </tbody>
    </table>
  </div>
`;


        document.body.appendChild(tooltip);
      };
      reader.readAsText(file);
    });

    uploadBtn.addEventListener("mousemove", (e) => {
      if (tooltip) {
        tooltip.classList.remove("hidden");
        tooltip.style.left = e.pageX + 15 + "px";
        tooltip.style.top = e.pageY + 15 + "px";
      }
    });

    uploadBtn.addEventListener("mouseleave", () => {
      if (tooltip) tooltip.classList.add("hidden");
    });
  </script>


</body>

</html>